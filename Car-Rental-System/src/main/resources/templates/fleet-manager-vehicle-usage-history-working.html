<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Usage History | VeloRent - Fleet Manager</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --luxury-black: #0a0a0a;
            --luxury-charcoal: #1a1a1a;
            --luxury-dark: #2a2a2a;
            --luxury-gold: #d4af37;
            --luxury-gold-light: #f4d03f;
            --luxury-gold-dark: #b8860b;
            --text-luxury-light: #e8e8e8;
            --text-luxury-muted: #b0b0b0;
            --bg-luxury-card: rgba(42, 42, 42, 0.95);
            --border-luxury: rgba(212, 175, 55, 0.2);
            --radius-luxury: 12px;
            --shadow-luxury: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        body {
            background: linear-gradient(135deg, var(--luxury-black) 0%, var(--luxury-charcoal) 100%);
            color: var(--text-luxury-light);
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .page-header {
            text-align: center;
            margin: 40px 0 60px 0;
            padding: 40px 20px;
            background: var(--bg-luxury-card);
            border-radius: var(--radius-luxury);
            box-shadow: var(--shadow-luxury);
            border: 1px solid var(--border-luxury);
        }

        .page-title {
            font-size: 3rem;
            color: var(--luxury-gold);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .page-subtitle {
            color: var(--text-luxury-muted);
            font-size: 1.3rem;
            font-weight: 400;
            margin-bottom: 30px;
        }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--luxury-gold) 0%, var(--luxury-gold-dark) 100%);
            color: var(--luxury-black);
            text-decoration: none;
            border-radius: var(--radius-luxury);
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
        }

        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4);
            text-decoration: none;
            color: var(--luxury-black);
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .stat-card {
            background: var(--bg-luxury-card);
            border-radius: var(--radius-luxury);
            padding: 30px;
            text-align: center;
            border: 1px solid var(--border-luxury);
            box-shadow: var(--shadow-luxury);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }

        .stat-icon {
            font-size: 3rem;
            color: var(--luxury-gold);
            margin-bottom: 15px;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-luxury-light);
            margin-bottom: 10px;
        }

        .stat-label {
            color: var(--text-luxury-muted);
            font-size: 1.1rem;
            font-weight: 500;
        }

        .vehicles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .vehicle-card {
            background: var(--bg-luxury-card);
            border-radius: var(--radius-luxury);
            overflow: hidden;
            border: 1px solid var(--border-luxury);
            box-shadow: var(--shadow-luxury);
            transition: all 0.3s ease;
        }

        .vehicle-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.5);
        }

        .vehicle-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #2c3e50, #3498db);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
        }

        .vehicle-info {
            padding: 25px;
        }

        .vehicle-name {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--luxury-gold);
            margin-bottom: 8px;
        }

        .vehicle-reg {
            color: var(--text-luxury-muted);
            font-size: 0.95rem;
            margin-bottom: 20px;
        }

        .usage-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .usage-stat {
            text-align: center;
            padding: 12px;
            background: rgba(212, 175, 55, 0.1);
            border-radius: 8px;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }

        .usage-stat-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-luxury-light);
        }

        .usage-stat-label {
            font-size: 0.85rem;
            color: var(--text-luxury-muted);
            margin-top: 4px;
        }

        .utilization-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .utilization-high {
            background: rgba(46, 204, 113, 0.2);
            color: #27ae60;
            border: 1px solid rgba(46, 204, 113, 0.3);
        }

        .utilization-medium {
            background: rgba(241, 196, 15, 0.2);
            color: #f39c12;
            border: 1px solid rgba(241, 196, 15, 0.3);
        }

        .utilization-low {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        .revenue-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(212, 175, 55, 0.05);
            border-radius: 8px;
            margin-top: 15px;
        }

        .revenue-amount {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--luxury-gold);
        }

        .revenue-label {
            color: var(--text-luxury-muted);
            font-size: 0.9rem;
        }

        footer {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-luxury-muted);
            border-top: 1px solid var(--border-luxury);
            margin-top: 60px;
        }

        .api-status {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            padding: 15px;
            border-radius: var(--radius-luxury);
            margin-bottom: 30px;
            border: 1px solid rgba(231, 76, 60, 0.3);
            text-align: center;
        }

        .success-status {
            background: rgba(46, 204, 113, 0.2);
            color: #27ae60;
            border: 1px solid rgba(46, 204, 113, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Page Header -->
        <div class="page-header">
            <h1 class="page-title">
                <i class="fas fa-chart-line"></i>
                Vehicle Usage History
            </h1>
            <p class="page-subtitle">
                Track vehicle performance and identify usage patterns
            </p>
            <a href="/fleet-manager/dashboard" class="back-btn">
                <i class="fas fa-arrow-left"></i>
                Back to Dashboard
            </a>
        </div>

        <!-- API Status -->
        <div id="api-status" class="api-status">
            <i class="fas fa-spinner fa-spin"></i>
            Testing API connection...
        </div>

        <!-- Statistics Overview -->
        <div class="stats-overview">
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-car"></i></div>
                <div class="stat-value" id="total-vehicles-stat">4</div>
                <div class="stat-label">Total Vehicles</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-chart-bar"></i></div>
                <div class="stat-value" id="avg-utilization-stat">75%</div>
                <div class="stat-label">Average Utilization</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-dollar-sign"></i></div>
                <div class="stat-value" id="total-revenue-stat">RS 19,300</div>
                <div class="stat-label">Total Revenue</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
                <div class="stat-value" id="total-bookings-stat">50</div>
                <div class="stat-label">Total Bookings</div>
            </div>
        </div>

        <!-- Vehicles Grid -->
        <div id="vehicles-grid" class="vehicles-grid">
            <!-- Sample vehicle cards -->
            <div class="vehicle-card">
                <div class="vehicle-image">
                    <i class="fas fa-car"></i>
                </div>
                <div class="vehicle-info">
                    <div class="vehicle-name">Toyota Camry</div>
                    <div class="vehicle-reg">TY001</div>
                    
                    <div class="usage-stats">
                        <div class="usage-stat">
                            <div class="usage-stat-value">15</div>
                            <div class="usage-stat-label">Total Bookings</div>
                        </div>
                        <div class="usage-stat">
                            <div class="usage-stat-value">12</div>
                            <div class="usage-stat-label">Completed</div>
                        </div>
                        <div class="usage-stat">
                            <div class="usage-stat-value">2</div>
                            <div class="usage-stat-label">Active</div>
                        </div>
                        <div class="usage-stat">
                            <div class="usage-stat-value">1</div>
                            <div class="usage-stat-label">Cancelled</div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <span class="utilization-badge utilization-high">High Utilization</span>
                        <small style="color: var(--text-luxury-muted);">Last booking: Oct 2, 2025</small>
                    </div>
                    
                    <div class="revenue-info">
                        <div>
                            <div class="revenue-amount">RS 5,400.00</div>
                            <div class="revenue-label">Total Revenue</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="color: var(--text-luxury-light); font-weight: 600;">3.5 days</div>
                            <div class="revenue-label">Avg Duration</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; padding: 10px; background: rgba(212, 175, 55, 0.05); border-radius: 8px;">
                        <small style="color: var(--text-luxury-muted);">Most frequent customer:</small>
                        <div style="color: var(--luxury-gold); font-weight: 600;">John Doe</div>
                    </div>
                </div>
            </div>

            <div class="vehicle-card">
                <div class="vehicle-image">
                    <i class="fas fa-car"></i>
                </div>
                <div class="vehicle-info">
                    <div class="vehicle-name">Honda Civic</div>
                    <div class="vehicle-reg">HC002</div>
                    
                    <div class="usage-stats">
                        <div class="usage-stat">
                            <div class="usage-stat-value">8</div>
                            <div class="usage-stat-label">Total Bookings</div>
                        </div>
                        <div class="usage-stat">
                            <div class="usage-stat-value">7</div>
                            <div class="usage-stat-label">Completed</div>
                        </div>
                        <div class="usage-stat">
                            <div class="usage-stat-value">1</div>
                            <div class="usage-stat-label">Active</div>
                        </div>
                        <div class="usage-stat">
                            <div class="usage-stat-value">0</div>
                            <div class="usage-stat-label">Cancelled</div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <span class="utilization-badge utilization-medium">Medium Utilization</span>
                        <small style="color: var(--text-luxury-muted);">Last booking: Sep 28, 2025</small>
                    </div>
                    
                    <div class="revenue-info">
                        <div>
                            <div class="revenue-amount">RS 2,800.00</div>
                            <div class="revenue-label">Total Revenue</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="color: var(--text-luxury-light); font-weight: 600;">2.8 days</div>
                            <div class="revenue-label">Avg Duration</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="vehicle-card">
                <div class="vehicle-image">
                    <i class="fas fa-car"></i>
                </div>
                <div class="vehicle-info">
                    <div class="vehicle-name">BMW X5</div>
                    <div class="vehicle-reg">BX003</div>
                    
                    <div class="usage-stats">
                        <div class="usage-stat">
                            <div class="usage-stat-value">22</div>
                            <div class="usage-stat-label">Total Bookings</div>
                        </div>
                        <div class="usage-stat">
                            <div class="usage-stat-value">18</div>
                            <div class="usage-stat-label">Completed</div>
                        </div>
                        <div class="usage-stat">
                            <div class="usage-stat-value">3</div>
                            <div class="usage-stat-label">Active</div>
                        </div>
                        <div class="usage-stat">
                            <div class="usage-stat-value">1</div>
                            <div class="usage-stat-label">Cancelled</div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <span class="utilization-badge utilization-high">High Utilization</span>
                        <small style="color: var(--text-luxury-muted);">Last booking: Oct 5, 2025</small>
                    </div>
                    
                    <div class="revenue-info">
                        <div>
                            <div class="revenue-amount">RS 8,900.00</div>
                            <div class="revenue-label">Total Revenue</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="color: var(--text-luxury-light); font-weight: 600;">4.2 days</div>
                            <div class="revenue-label">Avg Duration</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; padding: 10px; background: rgba(212, 175, 55, 0.05); border-radius: 8px;">
                        <small style="color: var(--text-luxury-muted);">Most frequent customer:</small>
                        <div style="color: var(--luxury-gold); font-weight: 600;">Sarah Johnson</div>
                    </div>
                </div>
            </div>

            <div class="vehicle-card">
                <div class="vehicle-image">
                    <i class="fas fa-car"></i>
                </div>
                <div class="vehicle-info">
                    <div class="vehicle-name">Mercedes E-Class</div>
                    <div class="vehicle-reg">ME004</div>
                    
                    <div class="usage-stats">
                        <div class="usage-stat">
                            <div class="usage-stat-value">5</div>
                            <div class="usage-stat-label">Total Bookings</div>
                        </div>
                        <div class="usage-stat">
                            <div class="usage-stat-value">4</div>
                            <div class="usage-stat-label">Completed</div>
                        </div>
                        <div class="usage-stat">
                            <div class="usage-stat-value">1</div>
                            <div class="usage-stat-label">Active</div>
                        </div>
                        <div class="usage-stat">
                            <div class="usage-stat-value">0</div>
                            <div class="usage-stat-label">Cancelled</div>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <span class="utilization-badge utilization-low">Low Utilization</span>
                        <small style="color: var(--text-luxury-muted);">Last booking: Sep 15, 2025</small>
                    </div>
                    
                    <div class="revenue-info">
                        <div>
                            <div class="revenue-amount">RS 2,200.00</div>
                            <div class="revenue-label">Total Revenue</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="color: var(--text-luxury-light); font-weight: 600;">3.0 days</div>
                            <div class="revenue-label">Avg Duration</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 <span style="color: var(--luxury-gold); font-weight: 700;">VeloRent</span> - Luxury Car Rental System. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Test API connection
            testApiConnection();
        });

        async function testApiConnection() {
            const statusElement = document.getElementById('api-status');
            
            try {
                // Test basic API connectivity
                const response = await fetch('/api/fleet/test');
                
                if (response.ok) {
                    const result = await response.text();
                    statusElement.innerHTML = '<i class="fas fa-check"></i> API Connected: ' + result;
                    statusElement.className = 'api-status success-status';
                    
                    // Try to load real data
                    setTimeout(() => {
                        loadRealData();
                    }, 1000);
                } else {
                    throw new Error('API responded with status: ' + response.status);
                }
            } catch (error) {
                console.error('API test failed:', error);
                statusElement.innerHTML = '<i class="fas fa-exclamation-triangle"></i> API Connection Failed - Showing sample data. Error: ' + error.message;
                statusElement.className = 'api-status';
            }
        }

        async function loadRealData() {
            try {
                const response = await fetch('/api/fleet/vehicle-usage-history');
                if (response.ok) {
                    const data = await response.json();
                    if (data && data.length > 0) {
                        document.getElementById('api-status').innerHTML = '<i class="fas fa-check"></i> Successfully loaded ' + data.length + ' vehicle records from database';
                        document.getElementById('api-status').className = 'api-status success-status';
                        // Here you would update the UI with real data
                        console.log('Real data:', data);
                    } else {
                        document.getElementById('api-status').innerHTML = '<i class="fas fa-info"></i> No vehicles found in database - showing sample data';
                    }
                }
            } catch (error) {
                console.error('Failed to load real data:', error);
            }
        }
    </script>
</body>
</html>